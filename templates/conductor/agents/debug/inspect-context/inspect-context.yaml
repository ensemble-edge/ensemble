name: inspect-context
version: 1.0.0
description: |
  Inspects and returns information about the current execution context.
  Useful for debugging auth propagation, headers, and environment variables.

  ⚠️ WARNING: Do NOT expose this on public endpoints in production -
  it may reveal internal state and configuration.

operation: code
handler: ./inspect-context.ts

tags:
  - debug
  - diagnostic
  - security-sensitive

schema:
  input:
    type: object
    properties:
      includeEnv:
        type: boolean
        default: false
        description: Include env var keys (values redacted)
      includeAuth:
        type: boolean
        default: true
        description: Include auth context
      includeHeaders:
        type: boolean
        default: true
        description: Include request headers (auth headers redacted)
      includeBindings:
        type: boolean
        default: false
        description: Include available Cloudflare bindings
  output:
    type: object
    properties:
      context:
        type: object
        properties:
          timestamp:
            type: string
          executionId:
            type: string
          requestId:
            type: string
          auth:
            type: object
          headers:
            type: object
          bindings:
            type: array
          env:
            type: object

examples:
  - name: basic-inspection
    description: Get basic context info
    input: {}
    output:
      context:
        timestamp: "2025-01-15T10:30:00Z"
        executionId: "exec_abc123"
        auth:
          authenticated: true
          userId: "user_123"

  - name: full-inspection
    description: Get everything (for debugging)
    input:
      includeEnv: true
      includeAuth: true
      includeHeaders: true
      includeBindings: true
