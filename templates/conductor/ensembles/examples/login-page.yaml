name: login-page
description: Render login page with session cookie management

agents:
  - name: render-login
    operation: html
    config:
      template:
        inline: |
          <!DOCTYPE html>
          <html lang="en">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Login - {{appName}}</title>

            <link href="/assets/styles/reset.css" rel="stylesheet">

            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
              }

              .login-container {
                background: white;
                border-radius: 16px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                padding: 3rem;
                width: 100%;
                max-width: 400px;
              }

              .logo {
                text-align: center;
                margin-bottom: 2rem;
              }

              .logo h1 {
                font-size: 2rem;
                font-weight: bold;
                color: #2D1B69;
                margin-bottom: 0.5rem;
              }

              .logo p {
                color: #718096;
                font-size: 0.875rem;
              }

              .form-group {
                margin-bottom: 1.5rem;
              }

              label {
                display: block;
                font-weight: 500;
                color: #2d3748;
                margin-bottom: 0.5rem;
              }

              input {
                width: 100%;
                padding: 0.75rem 1rem;
                border: 2px solid #e2e8f0;
                border-radius: 8px;
                font-size: 1rem;
                transition: border-color 0.2s;
              }

              input:focus {
                outline: none;
                border-color: #667eea;
              }

              button {
                width: 100%;
                padding: 0.875rem;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 8px;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: transform 0.2s;
              }

              button:hover {
                transform: translateY(-2px);
              }

              .remember-me {
                display: flex;
                align-items: center;
                margin-bottom: 1.5rem;
              }

              .remember-me input {
                width: auto;
                margin-right: 0.5rem;
              }

              .message {
                padding: 1rem;
                border-radius: 8px;
                margin-bottom: 1.5rem;
                font-size: 0.875rem;
              }

              .message.success {
                background: #c6f6d5;
                color: #22543d;
              }

              .message.error {
                background: #fed7d7;
                color: #742a2a;
              }

              {{#if cookies.session}}
              .already-logged-in {
                background: #bee3f8;
                color: #2c5282;
                padding: 1rem;
                border-radius: 8px;
                margin-bottom: 1.5rem;
                text-align: center;
              }
              {{/if}}
            </style>
          </head>
          <body>
            <div class="login-container">
              <div class="logo">
                <h1>{{appName}}</h1>
                <p>Sign in to your account</p>
              </div>

              {{#if cookies.session}}
              <div class="already-logged-in">
                You're already logged in as <strong>{{cookies.username}}</strong>
              </div>
              {{/if}}

              {{#if message}}
              <div class="message {{messageType}}">
                {{message}}
              </div>
              {{/if}}

              <form method="POST" action="/auth/login">
                <div class="form-group">
                  <label for="email">Email</label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    placeholder="you@example.com"
                    value="{{email}}"
                  >
                </div>

                <div class="form-group">
                  <label for="password">Password</label>
                  <input
                    type="password"
                    id="password"
                    name="password"
                    required
                    placeholder="••••••••"
                  >
                </div>

                <div class="remember-me">
                  <input type="checkbox" id="remember" name="remember">
                  <label for="remember" style="margin-bottom: 0;">Remember me</label>
                </div>

                <button type="submit">Sign In</button>
              </form>
            </div>
          </body>
          </html>
      cookieSecret: ${env.COOKIE_SECRET}
      defaultCookieOptions:
        httpOnly: true
        secure: true
        sameSite: lax
        maxAge: 604800  # 7 days

flow:
  - agent: render-login
    input:
      data:
        appName: ${input.appName}
        message: ${input.message}
        messageType: ${input.messageType}
        email: ${input.email}
      cookies: ${input.cookies}
      setCookies: ${input.setCookies}
      deleteCookies: ${input.deleteCookies}
